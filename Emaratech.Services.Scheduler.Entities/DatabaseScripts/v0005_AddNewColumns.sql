ALTER TABLE "JOB"
ADD (
	MAX_LOCK_SECONDS	INT
);

ALTER TABLE "JOB"
MODIFY (
	LOCKED_BY	NULL,
	LOCKED_DATE	NULL,
	EXECUTED_DATE	NULL,
	EXECUTED_BY	NULL
);

ALTER TABLE "JOB_SOURCE"
MODIFY (
	CLASS	NULL,
	PROCESS	NULL,
	API	NULL
);

ALTER TABLE "JOB_INSTANCE"
MODIFY (
	LOCKED_BY	NULL,
	LOCKED_DATE	NULL,
	EXECUTED_DATE	NULL,
	EXECUTED_BY	NULL
);

ALTER TABLE "JOB_INSTANCE" 
DROP (
  IS_LOCKED,
  LOCKED_BY,
  LOCKED_DATE
);

ALTER TABLE "JOB_SCHEDULE"
MODIFY (
	SCHEDULE_FREQUENCY INT DEFAULT 1
);

ALTER TABLE "JOB_SOURCE"
ADD (
	CONTENT	BLOB,
	JOB_ID	NVARCHAR2(32) NOT NULL
);

ALTER TABLE "JOB_SOURCE" DROP CONSTRAINT "FK_JOB_SOURCE_JOB";


ALTER TABLE "JOB_SCHEDULE"
ADD (
	START_DATE TIMESTAMP
);

ALTER TABLE "JOB_SCHEDULE" DROP CONSTRAINT "FK_JOB_SCHEDULE_JOB";
ALTER TABLE "JOB_INSTANCE" DROP CONSTRAINT "FK_JOB_INSTANCE_JOB";

INSERT INTO SCHEDULE_TYPE("ID", "TYPE") VALUES('00000000000000000000000000000001', 'Seconds');
INSERT INTO SCHEDULE_TYPE("ID", "TYPE") VALUES('00000000000000000000000000000002', 'Minutes');
INSERT INTO SCHEDULE_TYPE("ID", "TYPE") VALUES('00000000000000000000000000000003', 'Hours');
INSERT INTO SCHEDULE_TYPE("ID", "TYPE") VALUES('00000000000000000000000000000004', 'Days');
INSERT INTO SCHEDULE_TYPE("ID", "TYPE") VALUES('00000000000000000000000000000005', 'Weeks');
INSERT INTO SCHEDULE_TYPE("ID", "TYPE") VALUES('00000000000000000000000000000006', 'Months');
INSERT INTO SCHEDULE_TYPE("ID", "TYPE") VALUES('00000000000000000000000000000007', 'Years');

INSERT INTO "DB_VERSION"("VERSION") VALUES(4);

--
-- ROLLBACK
--
ALTER TABLE "JOB" 
DROP (
 MAX_LOCK_SECONDS
);

ALTER TABLE "JOB_SOURCE" 
DROP (
 CONTENT,
 JOB_ID
);

ALTER TABLE "JOB_SCHEDULE" 
DROP (
 START_DATE
);

INSERT INTO "DB_VERSION"("VERSION") VALUES(3);